<!DOCTYPE html>
<html lang="en">
<head>
  <meta name="viewport" content="initial-scale=1, minimum-scale=1, maximum-scale=1" />
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="x-ua-compatible" content="IE=10">
  <title>SCORM Course</title>

  <!-- ✅ SCORM + GA4 INJECTION START -->
  <script>
    (function () {
      const fakeAPI = {
        LMSInitialize: function () {
          console.log("✅ LMSInitialize triggered");
          if (typeof gtag === 'function') {
            gtag('event', 'CourseStarted', { debug_mode: true });
          }
          return "true";
        },
        LMSFinish: function () {
          console.log("✅ LMSFinish triggered");
          if (typeof gtag === 'function') {
            gtag('event', 'CourseCompleted', { debug_mode: true });
          }
          return "true";
        },
        LMSGetValue: function (name) { return ""; },
        LMSSetValue: function (name, value) { return "true"; },
        LMSCommit: function () { return "true"; },
        LMSGetLastError: function () { return "0"; },
        LMSGetErrorString: function (code) { return "No error"; },
        LMSGetDiagnostic: function (code) { return "No diagnostic available"; }
      };

      window.API = fakeAPI;
      window.parent.API = fakeAPI;
      window.top.API = fakeAPI;
    })();
  </script>

  <!-- ✅ Google Analytics 4 -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-VGK4EY7VMT"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'G-VGK4EY7VMT');
  </script>

  <style>
    #initialLoading {
      background: url(assets/htmlimages/loader.gif) no-repeat center center;
      background-color: #ffffff;
      position: absolute;
      top: 0; left: 0; right: 0; bottom: 0;
      z-index: 10010;
    }
  </style>
</head>
<body onload="onBodyLoad()">
  <div id="initialLoading"></div>

  <script>
    var deviceReady = false, initCalled = false, initialized = false;

    function onBodyLoad() {
      console.log("✅ Body Loaded");
      if (typeof window.device === 'undefined') {
        document.addEventListener("deviceready", onDeviceReady, false);
      } else {
        onDeviceReady();
      }
    }

    function onDeviceReady() {
      deviceReady = true;
      if (initCalled) initializeCP();
    }

    function initializeCP() {
      if (initialized) return;
      initCalled = true;
      if (!deviceReady) return;

      document.body.innerHTML = `
        <div class='cpMainContainer' id='cpDocument'>
          <div id='main_container' style='top:0px;position:absolute;'>
            <div id='projectBorder' style='top:0px;left:0px;position:absolute;display:block'></div>
            <div class='shadow' id='project_container' style='left: 0px; top:0px;position:absolute;'>
              <div id='project' class='cp-movie' style='width:1024px ;height:627px'>
                <div id='project_main' class='cp-timeline cp-main'>
                  <div id='div_Slide' onclick='cp.handleClick(event)' style='top:0px; width:1024px ;height:627px ;position:absolute;-webkit-tap-highlight-color: rgba(0,0,0,0);'></div>
                  <canvas id='slide_transition_canvas'></canvas>
                </div>
              </div>
            </div>
          </div>
          <div id='initialLoading'></div>
        </div>`;

      if (typeof cp !== 'undefined' && typeof cp.DoCPInit === 'function') {
        cp.DoCPInit();
      }

      initialized = true;
    }
  </script>

  <noscript style="text-align:center;font-size:24px;">
    Enable Javascript support in the browser.
  </noscript>
</body>
</html>
